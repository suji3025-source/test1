# test1
📝 Streamlit AI 서술형 평가 시스템

이 프로젝트는 Streamlit을 기반으로 구축된 AI 기반 서술형 평가 및 데이터 저장 시스템입니다.

학생들이 서술형 답안을 입력하면, OpenAI GPT가 이를 채점하여 즉각적인 피드백을 제공하고, 모든 데이터는 Supabase 데이터베이스에 자동으로 저장됩니다.

📊 시스템 구조 (Architecture)

graph TD
    User([학생]) -->|학번 및 답안 입력| UI[Streamlit 인터페이스]
    UI -->|제출 버튼 클릭| Validate{입력 확인}
    
    Validate -- 실패 --> Warning[경고 메시지 출력]
    Validate -- 성공 --> State[제출 완료 상태 전환]
    
    State -->|피드백 확인 버튼| AI_Logic[GPT 채점 로직]
    
    AI_Logic -->|API 요청| OpenAI[OpenAI API]
    OpenAI -->|채점 결과 반환| AI_Logic
    
    AI_Logic -->|결과 정규화 & 저장| DB[(Supabase DB)]
    AI_Logic -->|피드백 표시| Result[화면 결과 출력]


✨ 주요 기능

학생 정보 및 답안 수집: 학번과 3가지 과학 서술형 문항에 대한 답안을 입력받습니다.

실시간 유효성 검사: 빈 칸이 있는지 확인하여 제출 오류를 방지합니다.

AI 자동 채점 및 피드백:

OpenAI API를 활용하여 사전에 정의된 채점 기준(Rubric)에 따라 평가합니다.

"O: ..." 또는 "X: ..." 형식으로 결과를 정규화하여 출력합니다.

클라우드 데이터 저장:

학생의 답안, AI의 피드백, 채점 기준 등을 Supabase 테이블에 저장합니다.

교사는 추후 데이터를 조회하거나 분석할 수 있습니다.

🛠️ 설치 및 실행 방법 (Installation)

1. 필수 라이브러리 설치

터미널에서 아래 명령어를 실행하여 필요한 패키지를 설치하세요.

pip install streamlit openai supabase


2. Secrets 설정 (.streamlit/secrets.toml)

프로젝트 루트 폴더에 .streamlit 폴더를 만들고 secrets.toml 파일을 생성한 뒤, 아래 정보를 입력해야 합니다.

주의: API 키는 절대 깃허브 등 공개 저장소에 올리지 마세요.

# .streamlit/secrets.toml

OPENAI_API_KEY = "sk-..."  # OpenAI API Key 입력
SUPABASE_URL = "[https://your-project.supabase.co](https://your-project.supabase.co)"
SUPABASE_SERVICE_ROLE_KEY = "ey..." # Supabase Service Role Key (서버용)


3. 애플리케이션 실행

streamlit run app.py


📂 코드 구성 및 상세 설명

이 코드는 크게 두 단계(Step)로 나뉘어 있습니다.

Step 1: UI 구성 및 답안 제출

학번 입력: 학생 식별을 위한 필수 입력 필드입니다.

문항 구성:

기체 입자 운동과 온도

보일 법칙

열에너지 이동 방식

Form 처리: st.form을 사용하여 모든 답안을 작성한 후 한 번에 제출하도록 처리했습니다.

Step 2: AI 채점 및 DB 저장

OpenAI API 연동:

gpt-4o-mini (코드상 예시) 모델을 사용하여 비용 효율적으로 채점합니다.

프롬프트 엔지니어링을 통해 친절한 어조와 명확한 O/X 판정을 유도합니다.

피드백 정규화 (normalize_feedback):

AI의 응답이 형식을 벗어나더라도 강제로 포맷을 맞춰 UI 깨짐을 방지합니다.

Supabase 연동 (save_to_supabase):

채점 완료 즉시 student_submissions 테이블에 데이터를 Insert 합니다.

📋 Supabase 테이블 구조 예시

Supabase SQL Editor에서 아래 쿼리를 실행하여 테이블을 생성할 수 있습니다.

create table student_submissions (
  id bigint generated by default as identity primary key,
  student_id text not null,
  answer_1 text,
  answer_2 text,
  answer_3 text,
  feedback_1 text,
  feedback_2 text,
  feedback_3 text,
  model text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);


⚠️ 주의사항

API 비용: OpenAI API 호출 시 토큰 비용이 발생합니다.

보안: SUPABASE_SERVICE_ROLE_KEY는 모든 권한을 가진 키이므로 클라이언트(브라우저)에 노출되지 않도록 주의해야 합니다. (Streamlit은 서버 사이드에서 실행되므로 st.secrets를 통해 안전하게 관리됩니다.)
